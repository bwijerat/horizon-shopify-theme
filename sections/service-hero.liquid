{%- assign section_id = 'service-hero-' | append: section.id -%}

{% capture background_styles -%}
  {% if section.settings.background_image != blank %}
    background-image: url({{ section.settings.background_image | image_url: width: 3840 }});
    background-size: cover;
    background-repeat: no-repeat;
    background-position: center;
  {% endif %}
{%- endcapture -%}

{% capture inner_styles -%}
  --service-hero-inner-gap: {{ section.settings.content_media_gap }}px;
{%- endcapture -%}

{% capture actions_styles -%}
  --service-hero-actions-gap: {{ section.settings.button_gap }}px;
  --service-hero-actions-offset: {{ section.settings.subheading_button_gap }}px;
{%- endcapture -%}

{% capture media_styles -%}
  {% if section.settings.image_lock_aspect %}
    --service-hero-media-width: {{ section.settings.image_size_locked }}%;
  {% else %}
    --service-hero-media-width: {{ section.settings.image_width }}%;
    --service-hero-media-height: {{ section.settings.image_height }}px;
  {% endif %}
  --service-hero-media-max: {{ section.settings.media_max_width }}px;
  --service-hero-media-justify: {{ section.settings.media_horizontal_alignment }};
  --service-hero-media-align: {{ section.settings.media_vertical_alignment }};
  --service-hero-media-offset-x: {{ section.settings.media_offset_x }}px;
  --service-hero-media-offset-y: {{ section.settings.media_offset_y }}px;
{%- endcapture -%}

{%- assign buttons_markup = '' -%}
{%- assign buttons_count = 0 -%}
{%- assign hero_heading_fallback = '' -%}
{%- for block in section.blocks -%}
  {%- if block.type == 'hero_text' and block.settings.text_role == 'heading' -%}
    {%- assign hero_heading_fallback = block.settings.text | strip_html | strip -%}
    {%- break -%}
  {%- endif -%}
{%- endfor -%}

<div class="section-wrapper color-{{ section.settings.color_scheme }} service-hero__wrapper"{% if background_styles != blank %} style="{{ background_styles | strip_newlines }}"{% endif %}>
  <div
    id="{{ section_id }}"
    class="section service-hero page-width spacing-style"
    style="
      {% render 'spacing-style', settings: section.settings %}
    "
  >
    <div class="service-hero__inner" style="{{ inner_styles | strip_newlines }}">
      <div
        class="service-hero__content"
        style="--service-hero-heading-gap: {{ section.settings.heading_gap }}px;"
      >
        {%- for block in section.blocks -%}
          {%- case block.type -%}
            {%- when 'hero_text' -%}
              {%- assign role = block.settings.text_role | default: 'body' -%}
              {%- capture text_classes -%}
                service-hero__text service-hero__text--{{ role }}
                {%- if role == 'eyebrow' -%}
                  service-hero__eyebrow
                {%- elsif role == 'heading' -%}
                  service-hero__heading
                {%- elsif role == 'subheading' -%}
                  service-hero__subheading
                {%- endif -%}
              {%- endcapture -%}
              {%- assign text_class_value = text_classes | strip -%}
              {% render 'text', block: block, class: text_class_value %}
            {%- when 'button' -%}
              {%- liquid
                assign block_settings = block.settings
                assign button_link = block_settings.link
                if button_link == blank and block_settings.use_booking_link
                  assign button_link = settings.booking_page_link
                endif

                assign button_class = 'button'
                case block_settings.theme
                  when 'secondary'
                    assign button_class = 'button-secondary'
                  when 'booking'
                    assign button_class = 'button button--book'
                  when 'link'
                    assign button_class = 'link'
                  else
                    assign button_class = 'button'
                endcase
              -%}
              {%- capture button_size_style -%}
                {% render 'size-style', settings: block_settings %}
              {%- endcapture -%}
              {%- capture single_button -%}
                <a
                  {% if button_link == blank %}
                    role="link"
                    aria-disabled="true"
                  {% else %}
                    href="{{ button_link }}"
                  {% endif %}
                  class="service-hero__button size-style {{ button_class }} service-hero__button--{{ block.id }}"
                  style="{{ button_size_style | strip_newlines }}"
                  {% if block_settings.open_in_new_tab %}target="_blank" rel="noopener noreferrer"{% endif %}
                  {{ block.shopify_attributes }}
                >
                  {{ block_settings.label }}
                </a>
              {%- endcapture -%}
              {%- assign buttons_markup = buttons_markup | append: single_button -%}
              {%- assign buttons_count = buttons_count | plus: 1 -%}
          {%- endcase -%}
        {%- endfor -%}

        {%- if buttons_count > 0 -%}
          <div class="service-hero__actions" style="{{ actions_styles | strip_newlines }}">
            {{ buttons_markup }}
          </div>
        {%- endif -%}
      </div>

      <div
        class="service-hero__media {% if section.settings.image_lock_aspect %}service-hero__media--locked{% else %}service-hero__media--unlocked{% endif %}"
        style="{{ media_styles | strip_newlines }} justify-self: var(--service-hero-media-justify); align-self: var(--service-hero-media-align);"
      >
        {%- if section.settings.image != blank -%}
          {{
            section.settings.image
            | image_url: width: 1800
            | image_tag:
              loading: 'lazy',
              widths: '180, 360, 720, 960, 1200, 1500, 1800',
              sizes: '(min-width: 1200px) 50vw, 100vw',
              alt: section.settings.image_alt | default: hero_heading_fallback | default: shop.name | escape
          }}
        {%- else -%}
          <div class="service-hero__placeholder">
            <span>{{ 'Image placeholder' | t }}</span>
          </div>
        {%- endif -%}
      </div>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Service hero",
  "tag": "section",
  "class": "section-wrapper",
  "max_blocks": 12,
  "blocks": [
    {
      "type": "hero_text",
      "name": "Text",
      "settings": [
        {
          "type": "select",
          "id": "text_role",
          "label": "Text role",
          "options": [
            {
              "value": "eyebrow",
              "label": "Eyebrow"
            },
            {
              "value": "heading",
              "label": "Heading"
            },
            {
              "value": "subheading",
              "label": "Subheading"
            },
            {
              "value": "body",
              "label": "Body"
            }
          ],
          "default": "body"
        },
        {
          "type": "richtext",
          "id": "text",
          "label": "Text"
        },
        {
          "type": "header",
          "content": "Layout"
        },
        {
          "type": "select",
          "id": "width",
          "label": "Width",
          "options": [
            {
              "value": "fit-content",
              "label": "Fit content"
            },
            {
              "value": "100%",
              "label": "Fill width"
            }
          ],
          "default": "fit-content"
        },
        {
          "type": "select",
          "id": "max_width",
          "label": "Max width",
          "options": [
            {
              "value": "narrow",
              "label": "Narrow"
            },
            {
              "value": "normal",
              "label": "Normal"
            },
            {
              "value": "none",
              "label": "No limit"
            }
          ],
          "default": "normal"
        },
        {
          "type": "text_alignment",
          "id": "alignment",
          "label": "Alignment",
          "default": "left",
          "visible_if": "{{ block.settings.width == '100%' }}"
        },
        {
          "type": "header",
          "content": "Typography"
        },
        {
          "type": "select",
          "id": "type_preset",
          "label": "Preset",
          "options": [
            {
              "value": "rte",
              "label": "Default"
            },
            {
              "value": "paragraph",
              "label": "Paragraph"
            },
            {
              "value": "h1",
              "label": "H1"
            },
            {
              "value": "h2",
              "label": "H2"
            },
            {
              "value": "h3",
              "label": "H3"
            },
            {
              "value": "h4",
              "label": "H4"
            },
            {
              "value": "h5",
              "label": "H5"
            },
            {
              "value": "h6",
              "label": "H6"
            },
            {
              "value": "custom",
              "label": "Custom"
            }
          ],
          "default": "rte",
          "info": "Edit presets in theme settings."
        },
        {
          "type": "select",
          "id": "font",
          "label": "Font",
          "options": [
            {
              "value": "var(--font-body--family)",
              "label": "Body"
            },
            {
              "value": "var(--font-subheading--family)",
              "label": "Subheading"
            },
            {
              "value": "var(--font-heading--family)",
              "label": "Heading"
            },
            {
              "value": "var(--font-accent--family)",
              "label": "Accent"
            }
          ],
          "default": "var(--font-body--family)",
          "visible_if": "{{ block.settings.type_preset == 'custom' }}"
        },
        {
          "type": "select",
          "id": "font_size",
          "label": "Size",
          "options": [
            {
              "value": "",
              "label": "Default"
            },
            {
              "value": "0.625rem",
              "label": "10px"
            },
            {
              "value": "0.75rem",
              "label": "12px"
            },
            {
              "value": "0.875rem",
              "label": "14px"
            },
            {
              "value": "1rem",
              "label": "16px"
            },
            {
              "value": "1.125rem",
              "label": "18px"
            },
            {
              "value": "1.25rem",
              "label": "20px"
            },
            {
              "value": "1.5rem",
              "label": "24px"
            },
            {
              "value": "2rem",
              "label": "32px"
            },
            {
              "value": "2.5rem",
              "label": "40px"
            },
            {
              "value": "3rem",
              "label": "48px"
            },
            {
              "value": "3.5rem",
              "label": "56px"
            },
            {
              "value": "4.5rem",
              "label": "72px"
            },
            {
              "value": "5.5rem",
              "label": "88px"
            },
            {
              "value": "7.5rem",
              "label": "120px"
            },
            {
              "value": "9.5rem",
              "label": "152px"
            },
            {
              "value": "11.5rem",
              "label": "184px"
            }
          ],
          "default": "1rem",
          "visible_if": "{{ block.settings.type_preset == 'custom' }}"
        },
        {
          "type": "select",
          "id": "line_height",
          "label": "Line height",
          "options": [
            {
              "value": "tight",
              "label": "Tight"
            },
            {
              "value": "normal",
              "label": "Normal"
            },
            {
              "value": "loose",
              "label": "Loose"
            }
          ],
          "default": "normal",
          "visible_if": "{{ block.settings.type_preset == 'custom' }}"
        },
        {
          "type": "select",
          "id": "letter_spacing",
          "label": "Letter spacing",
          "options": [
            {
              "value": "tight",
              "label": "Tight"
            },
            {
              "value": "normal",
              "label": "Normal"
            },
            {
              "value": "loose",
              "label": "Loose"
            }
          ],
          "default": "normal",
          "visible_if": "{{ block.settings.type_preset == 'custom' }}"
        },
        {
          "type": "select",
          "id": "case",
          "label": "Case",
          "options": [
            {
              "value": "none",
              "label": "Default"
            },
            {
              "value": "uppercase",
              "label": "Uppercase"
            }
          ],
          "default": "none",
          "visible_if": "{{ block.settings.type_preset == 'custom' }}"
        },
        {
          "type": "select",
          "id": "wrap",
          "label": "Wrap",
          "options": [
            {
              "value": "pretty",
              "label": "Pretty"
            },
            {
              "value": "balance",
              "label": "Balance"
            },
            {
              "value": "nowrap",
              "label": "No wrap"
            }
          ],
          "visible_if": "{{ block.settings.type_preset == 'custom' }}"
        },
        {
          "type": "select",
          "id": "color",
          "label": "Color",
          "options": [
            {
              "value": "var(--color-foreground)",
              "label": "Text"
            },
            {
              "value": "var(--color-foreground-heading)",
              "label": "Heading"
            },
            {
              "value": "var(--color-primary)",
              "label": "Accent"
            }
          ],
          "default": "var(--color-foreground)",
          "visible_if": "{{ block.settings.type_preset != 'rte' }}"
        },
        {
          "type": "header",
          "content": "Appearance"
        },
        {
          "type": "checkbox",
          "id": "background",
          "label": "Show background",
          "default": false
        },
        {
          "type": "color",
          "id": "background_color",
          "label": "Background color",
          "alpha": true,
          "default": "#00000026",
          "visible_if": "{{ block.settings.background }}"
        },
        {
          "type": "range",
          "id": "corner_radius",
          "label": "Corner radius",
          "default": 0,
          "min": 0,
          "max": 50,
          "step": 1,
          "visible_if": "{{ block.settings.background }}"
        },
        {
          "type": "header",
          "content": "Padding"
        },
        {
          "type": "range",
          "id": "padding-block-start",
          "label": "Top padding",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "px",
          "default": 0
        },
        {
          "type": "range",
          "id": "padding-block-end",
          "label": "Bottom padding",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "px",
          "default": 0
        },
        {
          "type": "range",
          "id": "padding-inline-start",
          "label": "Left padding",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "px",
          "default": 0
        },
        {
          "type": "range",
          "id": "padding-inline-end",
          "label": "Right padding",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "px",
          "default": 0
        }
      ]
    },
    {
      "type": "button",
      "name": "Button",
      "settings": [
        {
          "type": "text",
          "id": "label",
          "label": "Label",
          "default": "Request a quote"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Link"
        },
        {
          "type": "checkbox",
          "id": "use_booking_link",
          "label": "Use booking page link",
          "info": "Uses the booking page link found in theme settings when left blank.",
          "default": false
        },
        {
          "type": "checkbox",
          "id": "open_in_new_tab",
          "label": "Open in new tab",
          "default": false
        },
        {
          "type": "select",
          "id": "theme",
          "label": "Button theme",
          "options": [
            {
              "value": "primary",
              "label": "Primary"
            },
            {
              "value": "booking",
              "label": "Booking"
            },
            {
              "value": "secondary",
              "label": "Secondary"
            },
            {
              "value": "link",
              "label": "Link"
            }
          ],
          "default": "primary"
        },
        {
          "type": "header",
          "content": "Size"
        },
        {
          "type": "select",
          "id": "width",
          "label": "Width",
          "options": [
            {
              "value": "fit-content",
              "label": "Fit content"
            },
            {
              "value": "custom",
              "label": "Custom"
            }
          ],
          "default": "fit-content"
        },
        {
          "type": "range",
          "id": "custom_width",
          "label": "Custom width",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "%",
          "default": 100,
          "visible_if": "{{ block.settings.width == 'custom' }}"
        },
        {
          "type": "select",
          "id": "width_mobile",
          "label": "Mobile width",
          "options": [
            {
              "value": "fit-content",
              "label": "Fit content"
            },
            {
              "value": "custom",
              "label": "Custom"
            }
          ],
          "default": "fit-content"
        },
        {
          "type": "range",
          "id": "custom_width_mobile",
          "label": "Custom width (mobile)",
          "min": 0,
          "max": 100,
          "step": 1,
          "unit": "%",
          "default": 100,
          "visible_if": "{{ block.settings.width_mobile == 'custom' }}"
        }
      ]
    }
  ],
  "settings": [
    {
      "type": "range",
      "id": "heading_gap",
      "label": "Spacing between heading and subheading",
      "min": 0,
      "max": 80,
      "step": 4,
      "unit": "px",
      "default": 16
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "range",
      "id": "subheading_button_gap",
      "label": "Spacing between text and buttons",
      "min": 0,
      "max": 120,
      "step": 4,
      "unit": "px",
      "default": 24,
      "info": "Applies even when the subheading is hidden."
    },
    {
      "type": "range",
      "id": "button_gap",
      "label": "Spacing between buttons",
      "min": 0,
      "max": 80,
      "step": 4,
      "unit": "px",
      "default": 16
    },
    {
      "type": "range",
      "id": "content_media_gap",
      "label": "Spacing between content and media",
      "min": 0,
      "max": 200,
      "step": 4,
      "unit": "px",
      "default": 64
    },
    {
      "type": "header",
      "content": "Media"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Foreground image"
    },
    {
      "type": "text",
      "id": "image_alt",
      "label": "Image alt text"
    },
    {
      "type": "checkbox",
      "id": "image_lock_aspect",
      "label": "Lock aspect ratio",
      "default": true
    },
    {
      "type": "range",
      "id": "image_size_locked",
      "label": "Image size",
      "min": 30,
      "max": 100,
      "step": 1,
      "unit": "%",
      "default": 100,
      "visible_if": "{{ section.settings.image_lock_aspect }}"
    },
    {
      "type": "range",
      "id": "image_width",
      "label": "Image width",
      "min": 30,
      "max": 120,
      "step": 1,
      "unit": "%",
      "default": 100,
      "visible_if": "{{ section.settings.image_lock_aspect != true }}"
    },
    {
      "type": "range",
      "id": "image_height",
      "label": "Image height",
      "min": 200,
      "max": 900,
      "step": 10,
      "unit": "px",
      "default": 480,
      "visible_if": "{{ section.settings.image_lock_aspect != true }}"
    },
    {
      "type": "header",
      "content": "Background"
    },
    {
      "type": "image_picker",
      "id": "background_image",
      "label": "Background image"
    },
    {
      "type": "range",
      "id": "media_max_width",
      "label": "Foreground image max width",
      "min": 240,
      "max": 1600,
      "step": 20,
      "unit": "px",
      "default": 1100
    },
    {
      "type": "select",
      "id": "media_horizontal_alignment",
      "label": "Foreground image horizontal align",
      "options": [
        { "value": "start", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "end", "label": "Right" }
      ],
      "default": "center"
    },
    {
      "type": "select",
      "id": "media_vertical_alignment",
      "label": "Foreground image vertical align",
      "options": [
        { "value": "start", "label": "Top" },
        { "value": "center", "label": "Center" },
        { "value": "end", "label": "Bottom" }
      ],
      "default": "center"
    },
    {
      "type": "range",
      "id": "media_offset_x",
      "label": "Foreground image horizontal offset",
      "min": -400,
      "max": 400,
      "step": 10,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "media_offset_y",
      "label": "Foreground image vertical offset",
      "min": -400,
      "max": 400,
      "step": 10,
      "unit": "px",
      "default": 0
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-4"
    },
    {
      "type": "header",
      "content": "Padding"
    },
    {
      "type": "range",
      "id": "padding-block-start",
      "label": "Top padding",
      "min": 0,
      "max": 160,
      "step": 4,
      "unit": "px",
      "default": 96
    },
    {
      "type": "range",
      "id": "padding-block-end",
      "label": "Bottom padding",
      "min": 0,
      "max": 160,
      "step": 4,
      "unit": "px",
      "default": 96
    }
  ],
  "presets": [
    {
      "name": "Service hero",
      "settings": {
        "color_scheme": "scheme-4"
      },
      "blocks": [
        {
          "type": "hero_text",
          "settings": {
            "text_role": "eyebrow",
            "text": "<p>HomeBase Support Services</p>",
            "type_preset": "paragraph",
            "case": "uppercase"
          }
        },
        {
          "type": "hero_text",
          "settings": {
            "text_role": "heading",
            "text": "<p>On-Demand Home Services You Can Rely On</p>",
            "type_preset": "h1"
          }
        },
        {
          "type": "hero_text",
          "settings": {
            "text_role": "subheading",
            "text": "<p>Snow removal, lawn care, IT support, and pet care for homeowners in your area.</p>",
            "type_preset": "paragraph"
          }
        },
        {
          "type": "button",
          "settings": {
            "label": "Request a Quote",
            "theme": "primary"
          }
        },
        {
          "type": "button",
          "settings": {
            "label": "Book Service",
            "theme": "booking",
            "use_booking_link": true
          }
        },
        {
          "type": "button",
          "settings": {
            "label": "View Services",
            "theme": "secondary"
          }
        }
      ]
    }
  ]
}
{% endschema %}

{% stylesheet %}
  .service-hero__inner {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--service-hero-inner-gap, var(--gap-xxl));
    align-items: center;
  }

  .service-hero__text {
    width: 100%;
  }

  .service-hero__eyebrow {
    letter-spacing: var(--letter-spacing, 0.04em);
    text-transform: var(--text-transform, uppercase);
    font-weight: var(--font-weight, 600);
    font-size: var(--font-size, 1.2rem);
    margin: 0;
  }

  .service-hero__content .custom-color,
  .service-hero__content .custom-color > :is(h1, h2, h3, h4, h5, h6, p, span, em, strong) {
    color: var(--color);
  }

  .service-hero__heading {
    margin: 0;
  }

  .service-hero__text--subheading {
    margin-top: var(--service-hero-heading-gap, 0);
    color: var(--color-foreground);
    max-width: 44rem;
    line-height: var(--line-height, 1.5);
  }

  .service-hero__actions {
    display: flex;
    gap: var(--service-hero-actions-gap, var(--gap-md));
    flex-wrap: wrap;
    margin-top: var(--service-hero-actions-offset, var(--gap-md));
  }

  .service-hero__button {
    text-decoration: none;
  }

  .service-hero__media {
    width: 100%;
    max-width: var(--service-hero-media-max, var(--service-hero-media-width, 100%));
    justify-self: var(--service-hero-media-justify, center);
    align-self: var(--service-hero-media-align, center);
    transform: translate(var(--service-hero-media-offset-x, 0px), var(--service-hero-media-offset-y, 0px));
  }

  .service-hero__media img {
    width: 100%;
    height: auto;
    border-radius: var(--style-border-radius-cards);
    object-fit: cover;
  }

  .service-hero__media--unlocked img {
    height: var(--service-hero-media-height, auto);
  }

  .service-hero__placeholder {
    width: 100%;
    min-height: 280px;
    border: 1px dashed var(--color-border);
    display: grid;
    place-items: center;
    color: var(--color-foreground);
    border-radius: var(--style-border-radius-cards);
  }

  @media screen and (min-width: 900px) {
    .service-hero__inner {
      grid-template-columns: 1.1fr 0.9fr;
    }
  }
{% endstylesheet %}
